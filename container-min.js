var Container=Class.create();Container.prototype={maxHeight:4096,initialize:function(){gadgets.rpc.register("resize_iframe",this.setHeight);gadgets.rpc.register("set_pref",this.setUserPref);gadgets.rpc.register("set_title",this.setTitle);gadgets.rpc.register("requestNavigateTo",this.requestNavigateTo)},setHeight:function(A){if(A>gadgets.container.maxHeight){A=gadgets.container.maxHeight}$(this.f).setStyle({height:A+"px"})},_parseIframeUrl:function(C){var B=new Object();var A=C.split("&");var D=key=val="";for(i=0;i<A.length-1;i++){D=A[i];key=D.substr(0,D.indexOf("="));val=D.substr(D.indexOf("=")+1);B[key]=val}return B},setUserPref:function(D,A,B){if($(this.f)!=undefined){var C=gadgets.container._parseIframeUrl($(this.f).src);new Ajax.Request("/prefs/set?st="+encodeURIComponent(C.st)+"&name="+encodeURIComponent(A)+"&value="+encodeURIComponent(B),{method:"get"})}},setTitle:function(B){var A=$(this.f+"_title");if(A!=undefined){A.update(B.replace(/&/g,"&amp;").replace(/</g,"&lt;"))}},_getUrlForView:function(A,B,D,C){if(A==="home"){return"/home"}else{if(A==="profile"){return"/profile/"+B}else{if(A==="canvas"){return"/profile/application/"+B+"/"+D+"/mod"}else{return null}}}},requestNavigateTo:function(A,D){var E=this._parseIframeUrl();var B=this._getUrlForView(A,E.owner,E.aid,E.mid);if(D){var C=JSON.stringify(D);if(C.length>0){B+="&appParams="+encodeURIComponent(C)}}if(B&&document.location.href.indexOf(B)==-1){document.location.href=B}}};gadgets.container=new Container();